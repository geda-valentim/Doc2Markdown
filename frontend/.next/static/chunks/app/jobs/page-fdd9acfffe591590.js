(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[531],{3219:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_});var a=t(5155),r=t(2115),l=t(63),n=t(9776),i=t(2454),c=t(549),d=t(1362),o=t(8874),u=t(5299),m=t(6983),x=t(5626),h=t(6651),j=t(9715),p=t(1360),f=t(7621),g=t(5895),b=t(7003),N=t(6170),v=t(3209),y=t(120),w=t(7830),k=t(8171);function _(){let e=(0,l.useRouter)(),s=(0,n.jE)(),{toast:t}=(0,k.dj)(),_=(0,g.n)(e=>null!==e.token&&null!==e.user),A=(0,g.n)(e=>e._hasHydrated),[C,q]=(0,r.useState)(""),[E,S]=(0,r.useState)("all"),[T,B]=(0,r.useState)(!1),[Z,F]=(0,r.useState)(null);(0,r.useEffect)(()=>{A&&!_&&e.push("/login")},[_,A,e]);let{data:P,isLoading:z,error:D}=(0,i.I)({queryKey:["jobs",E],queryFn:()=>f.Bt.list({job_type:"main",status:"all"===E?void 0:E,limit:50}),refetchInterval:1e4}),{data:I,isLoading:O}=(0,i.I)({queryKey:["search",C],queryFn:()=>f.Bt.search({query:C,limit:20}),enabled:C.length>0}),R=(0,c.n)({mutationFn:e=>f.Bt.delete(e),onSuccess:()=>{s.invalidateQueries({queryKey:["jobs"]}),t({title:"Job deleted",description:"The job has been successfully deleted."}),B(!1),F(null)},onError:e=>{var s,a;t({title:"Error deleting job",description:(null==(a=e.response)||null==(s=a.data)?void 0:s.detail)||"Failed to delete job",variant:"destructive"})}}),U=C?I:P,W=e=>{if(!e)return"Unknown";try{let s=new Date(e);if(isNaN(s.getTime()))return"Unknown";return(0,w.m)(s,{addSuffix:!0})}catch(e){return"Unknown"}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted",children:[(0,a.jsx)("header",{className:"border-b bg-background/95 backdrop-blur",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)(b.$,{variant:"ghost",onClick:()=>e.push("/dashboard"),children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})})}),(0,a.jsx)("main",{className:"container mx-auto px-4 py-12",children:(0,a.jsxs)("div",{className:"max-w-5xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"My Jobs"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"View and manage your document conversion jobs"})]}),(0,a.jsx)(v.Zp,{children:(0,a.jsx)(v.Wu,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(h.A,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(N.p,{placeholder:"Search jobs by content...",value:C,onChange:e=>q(e.target.value),className:"pl-9"})]}),(0,a.jsx)("div",{className:"flex gap-2",children:["all","queued","processing","completed","failed"].map(e=>(0,a.jsx)(b.$,{variant:E===e?"default":"outline",size:"sm",onClick:()=>S(e),className:"capitalize",children:e},e))})]})})}),D&&(0,a.jsx)(v.Zp,{className:"border-destructive",children:(0,a.jsxs)(v.Wu,{className:"py-6 text-center text-destructive",children:[(0,a.jsx)(o.A,{className:"h-12 w-12 mx-auto mb-4"}),(0,a.jsx)("p",{className:"font-semibold",children:"Error loading jobs"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:D instanceof Error?D.message:"Unknown error"})]})}),z||O?(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)(u.A,{className:"h-8 w-8 animate-spin text-primary"})}):U&&U.length>0?(0,a.jsx)("div",{className:"space-y-4",children:U.map(s=>(0,a.jsxs)(v.Zp,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>e.push("/jobs/".concat(s.job_id)),children:[(0,a.jsx)(v.aR,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(v.ZB,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"h-5 w-5"}),s.name||s.job_id]}),(0,a.jsxs)(v.BT,{className:"mt-1",children:["Created ",W(s.created_at)]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(e=>{switch(e){case"completed":return(0,a.jsx)(d.A,{className:"h-5 w-5 text-green-500"});case"failed":return(0,a.jsx)(o.A,{className:"h-5 w-5 text-red-500"});case"processing":return(0,a.jsx)(u.A,{className:"h-5 w-5 text-blue-500 animate-spin"});default:return(0,a.jsx)(m.A,{className:"h-5 w-5 text-yellow-500"})}})(s.status),(0,a.jsx)("span",{className:"font-medium capitalize ".concat((e=>{switch(e){case"completed":return"text-green-500";case"failed":return"text-red-500";case"processing":return"text-blue-500";default:return"text-yellow-500"}})(s.status)),children:s.status}),(0,a.jsx)(b.$,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:e=>{var t;return t=s.job_id,void(e.stopPropagation(),F(t),B(!0))},children:(0,a.jsx)(p.A,{className:"h-4 w-4"})})]})]})}),(0,a.jsxs)(v.Wu,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:s.total_pages&&(0,a.jsxs)("span",{children:[s.pages_completed||0," / ",s.total_pages," pages completed"]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Progress: ",(0,a.jsxs)("span",{className:"font-medium",children:[s.progress,"%"]})]}),s.completed_at&&(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Completed ",W(s.completed_at)]})]})]}),(0,a.jsx)("div",{className:"w-full bg-secondary rounded-full h-1.5 mt-3",children:(0,a.jsx)("div",{className:"bg-primary h-1.5 rounded-full transition-all duration-300",style:{width:"".concat(s.progress,"%")}})})]})]},s.job_id))}):(0,a.jsx)(v.Zp,{children:(0,a.jsxs)(v.Wu,{className:"py-12 text-center text-muted-foreground",children:[(0,a.jsx)(j.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:"No jobs found"}),C&&(0,a.jsx)("p",{className:"text-sm mt-2",children:"Try a different search query"})]})})]})}),(0,a.jsx)(y.Lt,{open:T,onOpenChange:B,children:(0,a.jsxs)(y.EO,{children:[(0,a.jsxs)(y.wd,{children:[(0,a.jsx)(y.r7,{children:"Are you sure?"}),(0,a.jsxs)(y.$v,{children:["This action cannot be undone. This will permanently delete the job and all its associated data including:",(0,a.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,a.jsx)("li",{children:"Job metadata"}),(0,a.jsx)("li",{children:"All pages and content"}),(0,a.jsx)("li",{children:"Markdown content"}),(0,a.jsx)("li",{children:"Temporary processing data"})]})]})]}),(0,a.jsxs)(y.ck,{children:[(0,a.jsx)(y.Zr,{children:"Cancel"}),(0,a.jsx)(y.Rx,{onClick:()=>{Z&&R.mutate(Z)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:R.isPending,children:R.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}},4579:(e,s,t)=>{Promise.resolve().then(t.bind(t,3219))},6170:(e,s,t)=>{"use strict";t.d(s,{p:()=>n});var a=t(5155),r=t(2115),l=t(5016);let n=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...n})});n.displayName="Input"},6651:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},e=>{e.O(0,[209,841,476,519,590,441,255,358],()=>e(e.s=4579)),_N_E=e.O()}]);